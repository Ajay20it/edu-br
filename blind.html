<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edu-Bridge - Inclusive Learning Platform</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=OpenDyslexic:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #4f46e5;
            --secondary-color: #06b6d4;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --error-color: #ef4444;
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
            --bg-primary: #ffffff;
            --bg-secondary: #f9fafb;
            --border-color: #e5e7eb;
            --focus-color: #3b82f6;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --border-radius: 12px;
            --transition: all 0.3s ease;
        }

        /* Dark Theme */
        [data-theme="dark"] {
            --text-primary: #f9fafb;
            --text-secondary: #d1d5db;
            --bg-primary: #1f2937;
            --bg-secondary: #111827;
            --border-color: #374151;
        }

        /* High Contrast Theme */
        [data-theme="high-contrast"] {
            --text-primary: #000000;
            --text-secondary: #333333;
            --bg-primary: #ffffff;
            --bg-secondary: #f0f0f0;
            --border-color: #000000;
            --primary-color: #0000ff;
            --secondary-color: #008000;
        }

        /* Dyslexia-friendly styles */
        .dyslexia-font {
            font-family: 'OpenDyslexic', Arial, sans-serif !important;
            letter-spacing: 0.12em;
            word-spacing: 0.16em;
            line-height: 1.8;
        }

        .blue-overlay { background-color: rgba(173, 216, 230, 0.3) !important; }
        .yellow-overlay { background-color: rgba(255, 255, 224, 0.5) !important; }
        .grey-overlay { background-color: rgba(128, 128, 128, 0.2) !important; }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            transition: var(--transition);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 2rem 0;
            text-align: center;
            box-shadow: var(--shadow-lg);
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        /* Accessibility Controls */
        .accessibility-bar {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .accessibility-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            align-items: center;
            justify-content: center;
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            background: var(--bg-primary);
            color: var(--text-primary);
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }

        .btn:hover, .btn:focus {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            outline: 2px solid var(--focus-color);
            outline-offset: 2px;
        }

        .btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .btn-success {
            background: var(--success-color);
            color: white;
            border-color: var(--success-color);
        }

        .btn-warning {
            background: var(--warning-color);
            color: white;
            border-color: var(--warning-color);
        }

        select {
            padding: 0.5rem;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 0.9rem;
        }

        /* Main Content */
        .main-content {
            padding: 2rem 0;
            min-height: 70vh;
        }

        /* Focus Mode */
        .focus-mode {
            background: var(--bg-primary);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            overflow: hidden;
        }

        .focus-mode.distraction-free {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 1000;
            border-radius: 0;
            display: flex;
            flex-direction: column;
        }

        /* Pomodoro Timer */
        .pomodoro-timer {
            background: var(--bg-secondary);
            padding: 1rem;
            text-align: center;
            border-bottom: 1px solid var(--border-color);
        }

        .timer-display {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }

        .timer-controls {
            display: flex;
            gap: 1rem;
            justify-content: center;
            align-items: center;
        }

        /* Lesson Content */
        .lesson-container {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
        }

        .lesson-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .lesson-card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
        }

        .lesson-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .lesson-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .lesson-number {
            background: var(--primary-color);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .lesson-content {
            margin-bottom: 2rem;
        }

        .lesson-content h3 {
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        .lesson-content p {
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .lesson-image {
            width: 100%;
            max-width: 400px;
            height: 200px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 3rem;
            margin: 1rem 0;
        }

        /* Progress Bar */
        .progress-container {
            background: var(--bg-secondary);
            padding: 1rem;
            border-top: 1px solid var(--border-color);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--border-color);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            border-radius: 4px;
            transition: width 0.5s ease;
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { background-position: -200px 0; }
            100% { background-position: calc(200px + 100%) 0; }
        }

        .progress-text {
            text-align: center;
            font-weight: 500;
            color: var(--text-secondary);
        }

        /* Navigation Controls */
        .lesson-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
            margin-top: 2rem;
        }

        /* Text-to-Speech Controls */
        .tts-controls {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 1rem;
            margin: 1rem 0;
        }

        .tts-controls h4 {
            margin-bottom: 1rem;
            color: var(--primary-color);
        }

        .voice-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            align-items: center;
        }

        /* AI Buddy */
        .ai-buddy {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }

        .buddy-toggle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
            transition: var(--transition);
        }

        .buddy-toggle:hover {
            transform: scale(1.1);
        }

        .buddy-panel {
            position: absolute;
            bottom: 70px;
            right: 0;
            width: 300px;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            padding: 1rem;
            display: none;
        }

        .buddy-panel.active {
            display: block;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .buddy-actions {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        /* Distraction Detection */
        .distraction-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .distraction-modal.active {
            display: flex;
        }

        .distraction-content {
            background: var(--bg-primary);
            border-radius: var(--border-radius);
            padding: 2rem;
            text-align: center;
            max-width: 400px;
            box-shadow: var(--shadow-lg);
        }

        .distraction-content h3 {
            color: var(--warning-color);
            margin-bottom: 1rem;
        }

        /* Celebration Modal */
        .celebration-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .celebration-modal.active {
            display: flex;
        }

        .celebration-content {
            background: var(--bg-primary);
            border-radius: var(--border-radius);
            padding: 3rem;
            text-align: center;
            max-width: 500px;
            box-shadow: var(--shadow-lg);
        }

        .celebration-emoji {
            font-size: 4rem;
            margin-bottom: 1rem;
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-30px); }
            60% { transform: translateY(-15px); }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }

            .accessibility-controls {
                flex-direction: column;
                gap: 0.5rem;
            }

            .lesson-container {
                padding: 1rem;
            }

            .lesson-navigation {
                flex-direction: column;
                gap: 1rem;
            }

            .voice-controls {
                flex-direction: column;
                align-items: stretch;
            }

            .buddy-panel {
                width: 280px;
                right: -10px;
            }
        }

        /* Focus styles for accessibility */
        *:focus {
            outline: 2px solid var(--focus-color);
            outline-offset: 2px;
        }

        /* Hidden content for screen readers */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
    </style>
</head>
<body data-theme="light">
    <div class="navigation">
        <a href="index.html" class="nav-btn">‚Üê Back to Home</a>
    </div>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <h1><i class="fas fa-graduation-cap"></i> Edu-Bridge</h1>
            <p>Inclusive Learning Platform for ADHD & Dyslexia Support</p>
        </div>
    </header>

    <!-- Accessibility Controls -->
    <div class="accessibility-bar">
        <div class="container">
            <div class="accessibility-controls">
                <div class="control-group">
                    <label for="theme-select" class="sr-only">Theme Selection</label>
                    <select id="theme-select" aria-label="Choose theme">
                        <option value="light">Light Theme</option>
                        <option value="dark">Dark Theme</option>
                        <option value="high-contrast">High Contrast</option>
                    </select>
                </div>

                <div class="control-group">
                    <button class="btn" id="dyslexia-toggle" aria-pressed="false">
                        <i class="fas fa-font"></i> Dyslexia Font
                    </button>
                </div>

                <div class="control-group">
                    <label for="overlay-select" class="sr-only">Background Overlay</label>
                    <select id="overlay-select" aria-label="Choose background overlay">
                        <option value="none">No Overlay</option>
                        <option value="blue">Blue Overlay</option>
                        <option value="yellow">Yellow Overlay</option>
                        <option value="grey">Grey Overlay</option>
                    </select>
                </div>

                <div class="control-group">
                    <button class="btn" id="focus-mode-toggle" aria-pressed="false">
                        <i class="fas fa-eye"></i> Focus Mode
                    </button>
                </div>

                <div class="control-group">
                    <button class="btn" id="tts-toggle" aria-pressed="false">
                        <i class="fas fa-volume-up"></i> Text-to-Speech
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <div class="focus-mode" id="focus-container">
                <!-- Pomodoro Timer -->
                <div class="pomodoro-timer" id="pomodoro-timer">
                    <div class="timer-display" id="timer-display">25:00</div>
                    <div class="timer-controls">
                        <button class="btn btn-primary" id="timer-start">
                            <i class="fas fa-play"></i> Start Focus
                        </button>
                        <button class="btn" id="timer-pause" disabled>
                            <i class="fas fa-pause"></i> Pause
                        </button>
                        <button class="btn" id="timer-reset">
                            <i class="fas fa-refresh"></i> Reset
                        </button>
                        <span class="timer-status" id="timer-status">Ready to focus</span>
                    </div>
                </div>

                <!-- Lesson Container -->
                <div class="lesson-container" id="lesson-container">
                    <!-- Lesson cards will be dynamically inserted here -->
                </div>

                <!-- Progress Container -->
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
                    </div>
                    <div class="progress-text" id="progress-text">Lesson 0 of 5 completed</div>

                    <!-- Navigation Controls -->
                    <div class="lesson-navigation">
                        <button class="btn" id="prev-lesson" disabled>
                            <i class="fas fa-chevron-left"></i> Previous
                        </button>

                        <div class="control-group">
                            <button class="btn btn-warning" id="repeat-lesson">
                                <i class="fas fa-redo"></i> Repeat
                            </button>
                        </div>

                        <button class="btn btn-primary" id="next-lesson">
                            Next <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Text-to-Speech Controls -->
            <div class="tts-controls" id="tts-controls" style="display: none;">
                <h4><i class="fas fa-volume-up"></i> Text-to-Speech Settings</h4>
                <div class="voice-controls">
                    <div class="control-group">
                        <label for="voice-select">Voice:</label>
                        <select id="voice-select" aria-label="Choose voice"></select>
                    </div>

                    <div class="control-group">
                        <label for="speed-select">Speed:</label>
                        <select id="speed-select" aria-label="Choose speech speed">
                            <option value="0.5">Slow</option>
                            <option value="0.8">Normal</option>
                            <option value="1.0" selected>Fast</option>
                            <option value="1.2">Very Fast</option>
                        </select>
                    </div>

                    <button class="btn btn-primary" id="read-lesson">
                        <i class="fas fa-play"></i> Read Current Lesson
                    </button>

                    <button class="btn" id="stop-reading">
                        <i class="fas fa-stop"></i> Stop Reading
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- AI Buddy -->
    <div class="ai-buddy">
        <button class="buddy-toggle" id="buddy-toggle" aria-label="Open AI Assistant">
            <i class="fas fa-robot"></i>
        </button>
        <div class="buddy-panel" id="buddy-panel">
            <h4><i class="fas fa-robot"></i> Learning Assistant</h4>
            <div class="buddy-actions">
                <button class="btn" id="buddy-repeat">
                    <i class="fas fa-redo"></i> Repeat That
                </button>
                <button class="btn" id="buddy-summarize">
                    <i class="fas fa-compress-alt"></i> Summarize
                </button>
                <button class="btn" id="buddy-visualize">
                    <i class="fas fa-eye"></i> Visualize
                </button>
                <button class="btn" id="buddy-help">
                    <i class="fas fa-question-circle"></i> Help
                </button>
            </div>
            <div id="buddy-response" style="margin-top: 1rem; padding: 1rem; background: var(--bg-secondary); border-radius: 8px; display: none;">
                <!-- AI responses will appear here -->
            </div>
        </div>
    </div>

    <!-- Distraction Detection Modal -->
    <div class="distraction-modal" id="distraction-modal">
        <div class="distraction-content">
            <h3><i class="fas fa-exclamation-triangle"></i> Distraction Detected!</h3>
            <p>It looks like you might be getting distracted. Would you like to switch to a more engaging learning mode?</p>
            <div style="margin-top: 1.5rem; display: flex; gap: 1rem; justify-content: center;">
                <button class="btn btn-primary" id="switch-to-game">
                    <i class="fas fa-gamepad"></i> Switch to Game Mode
                </button>
                <button class="btn" id="continue-focus">
                    <i class="fas fa-eye"></i> Continue Focusing
                </button>
            </div>
        </div>
    </div>

    <!-- Celebration Modal -->
    <div class="celebration-modal" id="celebration-modal">
        <div class="celebration-content">
            <div class="celebration-emoji">üéâ</div>
            <h2>Well Done!</h2>
            <p>You've completed another lesson! Keep up the great work!</p>
            <div id="session-stats" style="margin: 1.5rem 0; padding: 1rem; background: var(--bg-secondary); border-radius: 8px;">
                <!-- Session statistics will be shown here -->
            </div>
            <button class="btn btn-success" id="continue-learning">
                <i class="fas fa-arrow-right"></i> Continue Learning
            </button>
        </div>
    </div>

    <!-- Audio elements for feedback -->
    <audio id="success-sound" preload="auto">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT" type="audio/wav">
    </audio>

    <audio id="notification-sound" preload="auto">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT" type="audio/wav">
    </audio>

    <script>
        // ===== APPLICATION STATE =====
        let currentLesson = 0;
        let totalLessons = 5;
        let isTimerRunning = false;
        let timerInterval = null;
        let focusTime = 25 * 60; // 25 minutes in seconds
        let breakTime = 5 * 60; // 5 minutes in seconds
        let currentTime = focusTime;
        let isBreakTime = false;
        let distractionCount = 0;
        let lastActivity = Date.now();
        let activityCheckInterval = null;
        let speechSynthesis = window.speechSynthesis;
        let currentUtterance = null;
        let sessionStartTime = Date.now();
        let totalFocusTime = 0;
        let totalDistractions = 0;

        // ===== LESSON DATA =====
        const lessons = [
            {
                title: "Introduction to Mathematics",
                content: `
                    <h3>Welcome to Mathematics! üî¢</h3>
                    <p>Mathematics is the language of patterns, numbers, and logical thinking. In this lesson, we'll explore the fundamental concepts that make math both beautiful and practical.</p>
                    <div class="lesson-image">üìä</div>
                    <p>Mathematics helps us understand the world around us - from counting objects to measuring distances, from calculating change to understanding complex scientific phenomena.</p>
                    <p><strong>Key concepts we'll cover:</strong></p>
                    <ul>
                        <li>Numbers and counting</li>
                        <li>Basic operations (addition, subtraction)</li>
                        <li>Patterns and sequences</li>
                        <li>Problem-solving strategies</li>
                    </ul>
                `
            },
            {
                title: "Understanding Numbers",
                content: `
                    <h3>The World of Numbers üî¢</h3>
                    <p>Numbers are everywhere! They help us count, measure, and compare things in our daily lives.</p>
                    <div class="lesson-image">üî¢</div>
                    <p>Let's start with the basics:</p>
                    <p><strong>Natural Numbers:</strong> 1, 2, 3, 4, 5... These are the counting numbers we use every day.</p>
                    <p><strong>Zero:</strong> The number 0 represents "nothing" or "empty" - but it's very important in mathematics!</p>
                    <p>Try this: Look around your room and count 5 different objects. Notice how numbers help us organize and understand our world.</p>
                `
            },
            {
                title: "Addition - Putting Things Together",
                content: `
                    <h3>Addition: Combining Numbers ‚ûï</h3>
                    <p>Addition is like putting things together to see how many you have in total.</p>
                    <div class="lesson-image">‚ûï</div>
                    <p>When we add numbers, we're combining groups to find the total amount.</p>
                    <p><strong>Example:</strong> If you have 3 apples and someone gives you 2 more apples, how many apples do you have?</p>
                    <p>3 + 2 = 5 apples!</p>
                    <p><strong>Tips for Addition:</strong></p>
                    <ul>
                        <li>Start with the larger number and count up</li>
                        <li>Use your fingers to help count</li>
                        <li>Draw pictures to visualize the problem</li>
                        <li>Practice with everyday objects</li>
                    </ul>
                `
            },
            {
                title: "Subtraction - Taking Things Away",
                content: `
                    <h3>Subtraction: Finding the Difference ‚ûñ</h3>
                    <p>Subtraction is like taking things away to see how many are left.</p>
                    <div class="lesson-image">‚ûñ</div>
                    <p>When we subtract, we're removing some items from a group to find what remains.</p>
                    <p><strong>Example:</strong> If you have 7 cookies and you eat 3 of them, how many cookies are left?</p>
                    <p>7 - 3 = 4 cookies remaining!</p>
                    <p><strong>Tips for Subtraction:</strong></p>
                    <ul>
                        <li>Start with the larger number and count backwards</li>
                        <li>Use physical objects to take away</li>
                        <li>Think of it as "finding the difference"</li>
                        <li>Check your answer by adding back</li>
                    </ul>
                `
            },
            {
                title: "Problem Solving Strategies",
                content: `
                    <h3>Becoming a Math Detective üïµÔ∏è</h3>
                    <p>Problem solving is like being a detective - you need to find clues and put them together!</p>
                    <div class="lesson-image">üïµÔ∏è</div>
                    <p><strong>The STAR Method:</strong></p>
                    <ul>
                        <li><strong>S</strong>top and read the problem carefully</li>
                        <li><strong>T</strong>hink about what you know and what you need to find</li>
                        <li><strong>A</strong>ct by choosing a strategy and solving</li>
                        <li><strong>R</strong>eview your answer - does it make sense?</li>
                    </ul>
                    <p><strong>Problem-Solving Tools:</strong></p>
                    <ul>
                        <li>Draw pictures or diagrams</li>
                        <li>Make a list or table</li>
                        <li>Look for patterns</li>
                        <li>Work backwards</li>
                        <li>Guess and check</li>
                    </ul>
                    <p>Remember: Every math problem is a puzzle waiting to be solved! üß©</p>
                `
            }
        ];

        // ===== INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            loadPreferences();
            setupEventListeners();
            displayCurrentLesson();
            updateProgress();
            populateVoiceOptions();
            startActivityMonitoring();
        });

        function initializeApp() {
            // Set initial timer display
            updateTimerDisplay();

            // Initialize accessibility features
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.body.setAttribute('data-theme', savedTheme);
            document.getElementById('theme-select').value = savedTheme;

            // Initialize other preferences
            if (localStorage.getItem('dyslexiaFont') === 'true') {
                document.body.classList.add('dyslexia-font');
                document.getElementById('dyslexia-toggle').classList.add('active');
                document.getElementById('dyslexia-toggle').setAttribute('aria-pressed', 'true');
            }

            const savedOverlay = localStorage.getItem('overlay') || 'none';
            if (savedOverlay !== 'none') {
                document.body.classList.add(savedOverlay + '-overlay');
            }
            document.getElementById('overlay-select').value = savedOverlay;
        }

        function setupEventListeners() {
            // Theme selection
            document.getElementById('theme-select').addEventListener('change', function() {
                const theme = this.value;
                document.body.setAttribute('data-theme', theme);
                localStorage.setItem('theme', theme);
                playNotificationSound();
            });

            // Dyslexia font toggle
            document.getElementById('dyslexia-toggle').addEventListener('click', function() {
                const isActive = this.classList.contains('active');
                if (isActive) {
                    document.body.classList.remove('dyslexia-font');
                    this.classList.remove('active');
                    this.setAttribute('aria-pressed', 'false');
                    localStorage.setItem('dyslexiaFont', 'false');
                } else {
                    document.body.classList.add('dyslexia-font');
                    this.classList.add('active');
                    this.setAttribute('aria-pressed', 'true');
                    localStorage.setItem('dyslexiaFont', 'true');
                }
                playNotificationSound();
            });

            // Overlay selection
            document.getElementById('overlay-select').addEventListener('change', function() {
                // Remove existing overlay classes
                document.body.classList.remove('blue-overlay', 'yellow-overlay', 'grey-overlay');

                const overlay = this.value;
                if (overlay !== 'none') {
                    document.body.classList.add(overlay + '-overlay');
                }
                localStorage.setItem('overlay', overlay);
                playNotificationSound();
            });

            // Focus mode toggle
            document.getElementById('focus-mode-toggle').addEventListener('click', function() {
                const focusContainer = document.getElementById('focus-container');
                const isActive = this.classList.contains('active');

                if (isActive) {
                    focusContainer.classList.remove('distraction-free');
                    this.classList.remove('active');
                    this.setAttribute('aria-pressed', 'false');
                    this.innerHTML = '<i class="fas fa-eye"></i> Focus Mode';
                } else {
                    focusContainer.classList.add('distraction-free');
                    this.classList.add('active');
                    this.setAttribute('aria-pressed', 'true');
                    this.innerHTML = '<i class="fas fa-eye-slash"></i> Exit Focus';
                }
                playNotificationSound();
            });

            // Text-to-Speech toggle
            document.getElementById('tts-toggle').addEventListener('click', function() {
                const ttsControls = document.getElementById('tts-controls');
                const isActive = this.classList.contains('active');

                if (isActive) {
                    ttsControls.style.display = 'none';
                    this.classList.remove('active');
                    this.setAttribute('aria-pressed', 'false');
                    stopSpeaking();
                } else {
                    ttsControls.style.display = 'block';
                    this.classList.add('active');
                    this.setAttribute('aria-pressed', 'true');
                }
                playNotificationSound();
            });

            // Timer controls
            document.getElementById('timer-start').addEventListener('click', startTimer);
            document.getElementById('timer-pause').addEventListener('click', pauseTimer);
            document.getElementById('timer-reset').addEventListener('click', resetTimer);

            // Lesson navigation
            document.getElementById('prev-lesson').addEventListener('click', previousLesson);
            document.getElementById('next-lesson').addEventListener('click', nextLesson);
            document.getElementById('repeat-lesson').addEventListener('click', repeatLesson);

            // Text-to-Speech controls
            document.getElementById('read-lesson').addEventListener('click', readCurrentLesson);
            document.getElementById('stop-reading').addEventListener('click', stopSpeaking);

            // AI Buddy
            document.getElementById('buddy-toggle').addEventListener('click', toggleBuddyPanel);
            document.getElementById('buddy-repeat').addEventListener('click', () => handleBuddyAction('repeat'));
            document.getElementById('buddy-summarize').addEventListener('click', () => handleBuddyAction('summarize'));
            document.getElementById('buddy-visualize').addEventListener('click', () => handleBuddyAction('visualize'));
            document.getElementById('buddy-help').addEventListener('click', () => handleBuddyAction('help'));

            // Modal controls
            document.getElementById('switch-to-game').addEventListener('click', switchToGameMode);
            document.getElementById('continue-focus').addEventListener('click', closeDistractionModal);
            document.getElementById('continue-learning').addEventListener('click', closeCelebrationModal);

            // Keyboard navigation
            document.addEventListener('keydown', handleKeyboardNavigation);

            // Activity monitoring
            document.addEventListener('mousemove', updateActivity);
            document.addEventListener('keydown', updateActivity);
            document.addEventListener('click', updateActivity);
            document.addEventListener('visibilitychange', handleVisibilityChange);
        }

        // ===== LESSON MANAGEMENT =====
        function displayCurrentLesson() {
            const lessonContainer = document.getElementById('lesson-container');
            const lesson = lessons[currentLesson];

            lessonContainer.innerHTML = `
                <div class="lesson-card">
                    <div class="lesson-header">
                        <h2 class="lesson-title">${lesson.title}</h2>
                        <span class="lesson-number">Lesson ${currentLesson + 1}</span>
                    </div>
                    <div class="lesson-content">
                        ${lesson.content}
                    </div>
                </div>
            `;

            // Update navigation buttons
            document.getElementById('prev-lesson').disabled = currentLesson === 0;
            document.getElementById('next-lesson').disabled = currentLesson === totalLessons - 1;

            // Update next button text
            const nextBtn = document.getElementById('next-lesson');
            if (currentLesson === totalLessons - 1) {
                nextBtn.innerHTML = '<i class="fas fa-check"></i> Complete Course';
            } else {
                nextBtn.innerHTML = 'Next <i class="fas fa-chevron-right"></i>';
            }
        }

        function nextLesson() {
            if (currentLesson < totalLessons - 1) {
                currentLesson++;
                displayCurrentLesson();
                updateProgress();
                playSuccessSound();

                // Show celebration for lesson completion
                if (currentLesson > 0) {
                    showCelebration();
                }
            } else {
                // Course completed
                showCourseCompletion();
            }
        }

        function previousLesson() {
            if (currentLesson > 0) {
                currentLesson--;
                displayCurrentLesson();
                updateProgress();
                playNotificationSound();
            }
        }

        function repeatLesson() {
            displayCurrentLesson();
            playNotificationSound();

            // If TTS is active, read the lesson
            if (document.getElementById('tts-toggle').classList.contains('active')) {
                setTimeout(readCurrentLesson, 500);
            }
        }

        function updateProgress() {
            const progressFill = document.getElementById('progress-fill');
            const progressText = document.getElementById('progress-text');

            const progressPercentage = ((currentLesson + 1) / totalLessons) * 100;
            progressFill.style.width = progressPercentage + '%';
            progressText.textContent = `Lesson ${currentLesson + 1} of ${totalLessons} completed`;
        }

        // ===== POMODORO TIMER =====
        function startTimer() {
            if (!isTimerRunning) {
                isTimerRunning = true;
                sessionStartTime = Date.now();

                document.getElementById('timer-start').disabled = true;
                document.getElementById('timer-pause').disabled = false;
                document.getElementById('timer-status').textContent = isBreakTime ? 'Break time!' : 'Focus time!';

                timerInterval = setInterval(updateTimer, 1000);
                playNotificationSound();
            }
        }

        function pauseTimer() {
            if (isTimerRunning) {
                isTimerRunning = false;
                clearInterval(timerInterval);

                document.getElementById('timer-start').disabled = false;
                document.getElementById('timer-pause').disabled = true;
                document.getElementById('timer-status').textContent = 'Timer paused';

                playNotificationSound();
            }
        }

        function resetTimer() {
            isTimerRunning = false;
            clearInterval(timerInterval);

            currentTime = isBreakTime ? breakTime : focusTime;
            updateTimerDisplay();

            document.getElementById('timer-start').disabled = false;
            document.getElementById('timer-pause').disabled = true;
            document.getElementById('timer-status').textContent = 'Ready to focus';

            playNotificationSound();
        }

        function updateTimer() {
            currentTime--;
            updateTimerDisplay();

            if (currentTime <= 0) {
                // Timer finished
                clearInterval(timerInterval);
                isTimerRunning = false;

                if (isBreakTime) {
                    // Break finished, start focus time
                    isBreakTime = false;
                    currentTime = focusTime;
                    document.getElementById('timer-status').textContent = 'Break finished! Ready for focus time.';
                } else {
                    // Focus time finished, start break
                    isBreakTime = true;
                    currentTime = breakTime;
                    totalFocusTime += focusTime;
                    document.getElementById('timer-status').textContent = 'Great focus! Time for a break.';
                }

                updateTimerDisplay();
                document.getElementById('timer-start').disabled = false;
                document.getElementById('timer-pause').disabled = true;

                playSuccessSound();

                // Show notification
                if (Notification.permission === 'granted') {
                    new Notification(isBreakTime ? 'Break Time!' : 'Focus Time!', {
                        body: isBreakTime ? 'Take a 5-minute break.' : 'Ready for another focus session?',
                        icon: '/favicon.ico'
                    });
                }
            }
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(currentTime / 60);
            const seconds = currentTime % 60;
            const display = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('timer-display').textContent = display;
        }

        // ===== DISTRACTION DETECTION =====
        function startActivityMonitoring() {
            activityCheckInterval = setInterval(checkForDistraction, 10000); // Check every 10 seconds

            // Request notification permission
            if (Notification.permission === 'default') {
                Notification.requestPermission();
            }
        }

        function updateActivity() {
            lastActivity = Date.now();
        }

        function handleVisibilityChange() {
            if (document.hidden) {
                // User switched tabs or minimized window
                if (isTimerRunning) {
                    distractionCount++;
                    totalDistractions++;

                    if (distractionCount >= 3) {
                        showDistractionModal();
                    }
                }
            } else {
                updateActivity();
            }
        }

        function checkForDistraction() {
            const timeSinceLastActivity = Date.now() - lastActivity;
            const inactivityThreshold = 30000; // 30 seconds

            if (timeSinceLastActivity > inactivityThreshold && isTimerRunning) {
                distractionCount++;
                totalDistractions++;

                if (distractionCount >= 3) {
                    showDistractionModal();
                }
            }
        }

        function showDistractionModal() {
            pauseTimer();
            document.getElementById('distraction-modal').classList.add('active');
            playNotificationSound();
        }

        function closeDistractionModal() {
            document.getElementById('distraction-modal').classList.remove('active');
            distractionCount = 0; // Reset distraction count
        }

        function switchToGameMode() {
            // Redirect to game.html (you would create this file)
            window.location.href = 'game.html';
        }

        // ===== TEXT-TO-SPEECH =====
        function populateVoiceOptions() {
            const voiceSelect = document.getElementById('voice-select');

            function loadVoices() {
                const voices = speechSynthesis.getVoices();
                voiceSelect.innerHTML = '';

                voices.forEach((voice, index) => {
                    const option = document.createElement('option');
                    option.value = index;
                    option.textContent = `${voice.name} (${voice.lang})`;
                    voiceSelect.appendChild(option);
                });
            }

            loadVoices();
            speechSynthesis.onvoiceschanged = loadVoices;
        }

        function readCurrentLesson() {
            const lessonContent = document.querySelector('.lesson-content');
            if (lessonContent) {
                const textToRead = lessonContent.textContent;
                speak(textToRead);
            }
        }

        function speak(text) {
            stopSpeaking();

            currentUtterance = new SpeechSynthesisUtterance(text);

            const voiceSelect = document.getElementById('voice-select');
            const speedSelect = document.getElementById('speed-select');

            if (voiceSelect.value) {
                const voices = speechSynthesis.getVoices();
                currentUtterance.voice = voices[voiceSelect.value];
            }

            currentUtterance.rate = parseFloat(speedSelect.value);
            currentUtterance.pitch = 1;
            currentUtterance.volume = 1;

            speechSynthesis.speak(currentUtterance);
        }

        function stopSpeaking() {
            if (speechSynthesis.speaking) {
                speechSynthesis.cancel();
            }
        }

        // ===== AI BUDDY =====
        function toggleBuddyPanel() {
            const panel = document.getElementById('buddy-panel');
            panel.classList.toggle('active');
            playNotificationSound();
        }

        function handleBuddyAction(action) {
            const responseDiv = document.getElementById('buddy-response');
            let response = '';

            switch (action) {
                case 'repeat':
                    response = `
                        <h5>üìö Let me repeat that for you!</h5>
                        <p>The current lesson is about <strong>${lessons[currentLesson].title}</strong>.
                        The main points are the key concepts we're learning to build a strong foundation in mathematics.</p>
                        <p>Would you like me to read the lesson aloud? Just click the "Read Current Lesson" button! üîä</p>
                    `;
                    break;

                case 'summarize':
                    response = `
                        <h5>üìù Quick Summary</h5>
                        <p><strong>${lessons[currentLesson].title}</strong></p>
                        <p>üéØ <strong>Main idea:</strong> This lesson introduces fundamental concepts that will help you understand and apply mathematical thinking.</p>
                        <p>üí° <strong>Key takeaway:</strong> Practice makes perfect! Take your time and don't worry if it takes a few tries to understand.</p>
                    `;
                    break;

                case 'visualize':
                    response = `
                        <h5>üé® Visual Learning Tips</h5>
                        <p>Try these visualization techniques:</p>
                        <ul>
                            <li>üñºÔ∏è Draw pictures or diagrams</li>
                            <li>üî¢ Use physical objects to count</li>
                            <li>üìä Create charts or tables</li>
                            <li>üåà Use colors to organize information</li>
                        </ul>
                        <p>Visual learning helps your brain remember better! üß†‚ú®</p>
                    `;
                    break;

                case 'help':
                    response = `
                        <h5>üÜò Need Help?</h5>
                        <p>Here are some tips for successful learning:</p>
                        <ul>
                            <li>üéØ Use Focus Mode to minimize distractions</li>
                            <li>‚è∞ Try the Pomodoro timer for better concentration</li>
                            <li>üîä Use Text-to-Speech if reading is challenging</li>
                            <li>üé® Switch to dyslexia-friendly font if needed</li>
                            <li>üåà Try different background overlays for comfort</li>
                        </ul>
                        <p>Remember: Everyone learns differently, and that's perfectly okay! üí™</p>
                    `;
                    break;
            }

            responseDiv.innerHTML = response;
            responseDiv.style.display = 'block';
            playNotificationSound();
        }

        // ===== CELEBRATION & FEEDBACK =====
        function showCelebration() {
            const modal = document.getElementById('celebration-modal');
            const statsDiv = document.getElementById('session-stats');

            const sessionTime = Math.floor((Date.now() - sessionStartTime) / 1000 / 60);

            statsDiv.innerHTML = `
                <h4>üìä Session Statistics</h4>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 1rem; text-align: center;">
                    <div>
                        <div style="font-size: 1.5rem; color: var(--success-color);">${sessionTime}</div>
                        <div style="font-size: 0.9rem;">Minutes Studied</div>
                    </div>
                    <div>
                        <div style="font-size: 1.5rem; color: var(--primary-color);">${currentLesson + 1}</div>
                        <div style="font-size: 0.9rem;">Lessons Completed</div>
                    </div>
                    <div>
                        <div style="font-size: 1.5rem; color: var(--warning-color);">${totalDistractions}</div>
                        <div style="font-size: 0.9rem;">Distractions</div>
                    </div>
                </div>
            `;

            modal.classList.add('active');
            playSuccessSound();

            // Add confetti effect
            createConfetti();
        }

        function showCourseCompletion() {
            const modal = document.getElementById('celebration-modal');
            const content = modal.querySelector('.celebration-content');

            content.innerHTML = `
                <div class="celebration-emoji">üèÜ</div>
                <h2>Course Completed!</h2>
                <p>Congratulations! You've successfully completed the entire mathematics course!</p>
                <div style="margin: 1.5rem 0; padding: 1rem; background: var(--bg-secondary); border-radius: 8px;">
                    <h4>üéâ Final Statistics</h4>
                    <p><strong>Total Lessons:</strong> ${totalLessons}</p>
                    <p><strong>Total Study Time:</strong> ${Math.floor(totalFocusTime / 60)} minutes</p>
                    <p><strong>Focus Sessions:</strong> ${Math.floor(totalFocusTime / (25 * 60))}</p>
                </div>
                <button class="btn btn-success" onclick="restartCourse()">
                    <i class="fas fa-refresh"></i> Start New Course
                </button>
            `;

            modal.classList.add('active');
            playSuccessSound();
            createConfetti();
        }

        function closeCelebrationModal() {
            document.getElementById('celebration-modal').classList.remove('active');
        }

        function restartCourse() {
            currentLesson = 0;
            totalDistractions = 0;
            totalFocusTime = 0;
            distractionCount = 0;
            sessionStartTime = Date.now();

            displayCurrentLesson();
            updateProgress();
            closeCelebrationModal();

            playNotificationSound();
        }

        function createConfetti() {
            // Simple confetti effect using CSS animations
            const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#feca57'];

            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.style.position = 'fixed';
                confetti.style.width = '10px';
                confetti.style.height = '10px';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.top = '-10px';
                confetti.style.zIndex = '9999';
                confetti.style.pointerEvents = 'none';
                confetti.style.animation = `fall ${Math.random() * 3 + 2}s linear forwards`;

                document.body.appendChild(confetti);

                setTimeout(() => {
                    confetti.remove();
                }, 5000);
            }
        }

        // ===== KEYBOARD NAVIGATION =====
        function handleKeyboardNavigation(event) {
            // Escape key to close modals
            if (event.key === 'Escape') {
                document.getElementById('distraction-modal').classList.remove('active');
                document.getElementById('celebration-modal').classList.remove('active');
                document.getElementById('buddy-panel').classList.remove('active');
                stopSpeaking();
            }

            // Arrow keys for lesson navigation
            if (event.key === 'ArrowLeft' && !document.getElementById('prev-lesson').disabled) {
                previousLesson();
            }

            if (event.key === 'ArrowRight' && !document.getElementById('next-lesson').disabled) {
                nextLesson();
            }

            // Space bar to start/pause timer
            if (event.key === ' ' && event.target.tagName !== 'BUTTON' && event.target.tagName !== 'SELECT') {
                event.preventDefault();
                if (isTimerRunning) {
                    pauseTimer();
                } else {
                    startTimer();
                }
            }
        }

        // ===== AUDIO FEEDBACK =====
        function playSuccessSound() {
            const audio = document.getElementById('success-sound');
            audio.currentTime = 0;
            audio.play().catch(() => {}); // Ignore errors if audio can't play
        }

        function playNotificationSound() {
            const audio = document.getElementById('notification-sound');
            audio.currentTime = 0;
            audio.play().catch(() => {}); // Ignore errors if audio can't play
        }

        // ===== PREFERENCES =====
        function loadPreferences() {
            // Load saved lesson progress
            const savedLesson = localStorage.getItem('currentLesson');
            if (savedLesson) {
                currentLesson = parseInt(savedLesson);
            }

            // Load other preferences (already handled in initializeApp)
        }

        function savePreferences() {
            localStorage.setItem('currentLesson', currentLesson.toString());
        }

        // Save preferences periodically
        setInterval(savePreferences, 30000); // Every 30 seconds

        // Save preferences when page unloads
        window.addEventListener('beforeunload', savePreferences);

        // Add CSS for confetti animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fall {
                to {
                    transform: translateY(100vh) rotate(360deg);
                }
            }
        `;
        document.head.appendChild(style);

        console.log('üéì Edu-Bridge Learning Platform Loaded Successfully!');
        console.log('‚ú® Features: ADHD Support, Dyslexia Support, Focus Mode, Pomodoro Timer, TTS, AI Buddy');
    </script>
</body>
</html>

    <!-- Accessibility Controls -->
    <div class="accessibility-bar">
        <div class="container">
            <div class="accessibility-controls">
                <div class="control-group">
                    <label for="theme-select" class="sr-only">Theme Selection</label>
                    <select id="theme-select" aria-label="Choose theme">
                        <option value="light">Light Theme</option>
                        <option value="dark">Dark Theme</option>
                        <option value="high-contrast">High Contrast</option>
                    </select>
                </div>

                <div class="control-group">
                    <button class="btn" id="dyslexia-toggle" aria-pressed="false">
                        <i class="fas fa-font"></i> Dyslexia Font
                    </button>
                </div>

                <div class="control-group">
                    <label for="overlay-select" class="sr-only">Background Overlay</label>
                    <select id="overlay-select" aria-label="Choose background overlay">
                        <option value="none">No Overlay</option>
                        <option value="blue">Blue Overlay</option>
                        <option value="yellow">Yellow Overlay</option>
                        <option value="grey">Grey Overlay</option>
                    </select>
                </div>

                <div class="control-group">
                    <button class="btn" id="focus-mode-toggle" aria-pressed="false">
                        <i class="fas fa-eye"></i> Focus Mode
                    </button>
                </div>

                <div class="control-group">
                    <button class="btn" id="tts-toggle" aria-pressed="false">
                        <i class="fas fa-volume-up"></i> Text-to-Speech
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <div class="focus-mode" id="focus-container">
                <!-- Pomodoro Timer -->
                <div class="pomodoro-timer" id="pomodoro-timer">
                    <div class="timer-display" id="timer-display">25:00</div>
                    <div class="timer-controls">
                        <button class="btn btn-primary" id="timer-start">
                            <i class="fas fa-play"></i> Start Focus
                        </button>
                        <button class="btn" id="timer-pause" disabled>
                            <i class="fas fa-pause"></i> Pause
                        </button>
                        <button class="btn" id="timer-reset">
                            <i class="fas fa-refresh"></i> Reset
                        </button>
                        <span class="timer-status" id="timer-status">Ready to focus</span>
                    </div>
                </div>

                <!-- Lesson Container -->
                <div class="lesson-container" id="lesson-container">
                    <!-- Lesson cards will be dynamically inserted here -->
                </div>

                <!-- Progress Container -->
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
                    </div>
                    <div class="progress-text" id="progress-text">Lesson 0 of 5 completed</div>

                    <!-- Navigation Controls -->
                    <div class="lesson-navigation">
                        <button class="btn" id="prev-lesson" disabled>
                            <i class="fas fa-chevron-left"></i> Previous
                        </button>

                        <div class="control-group">
                            <button class="btn btn-warning" id="repeat-lesson">
                                <i class="fas fa-redo"></i> Repeat
                            </button>
                        </div>

                        <button class="btn btn-primary" id="next-lesson">
                            Next <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Text-to-Speech Controls -->
            <div class="tts-controls" id="tts-controls" style="display: none;">
                <h4><i class="fas fa-volume-up"></i> Text-to-Speech Settings</h4>
                <div class="voice-controls">
                    <div class="control-group">
                        <label for="voice-select">Voice:</label>
                        <select id="voice-select" aria-label="Choose voice"></select>
                    </div>

                    <div class="control-group">
                        <label for="speed-select">Speed:</label>
                        <select id="speed-select" aria-label="Choose speech speed">
                            <option value="0.5">Slow</option>
                            <option value="0.8">Normal</option>
                            <option value="1.0" selected>Fast</option>
                            <option value="1.2">Very Fast</option>
                        </select>
                    </div>

                    <button class="btn btn-primary" id="read-lesson">
                        <i class="fas fa-play"></i> Read Current Lesson
                    </button>

                    <button class="btn" id="stop-reading">
                        <i class="fas fa-stop"></i> Stop Reading
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- AI Buddy -->
    <div class="ai-buddy">
        <button class="buddy-toggle" id="buddy-toggle" aria-label="Open AI Assistant">
            <i class="fas fa-robot"></i>
        </button>
        <div class="buddy-panel" id="buddy-panel">
            <h4><i class="fas fa-robot"></i> Learning Assistant</h4>
            <div class="buddy-actions">
                <button class="btn" id="buddy-repeat">
                    <i class="fas fa-redo"></i> Repeat That
                </button>
                <button class="btn" id="buddy-summarize">
                    <i class="fas fa-compress-alt"></i> Summarize
                </button>
                <button class="btn" id="buddy-visualize">
                    <i class="fas fa-eye"></i> Visualize
                </button>
                <button class="btn" id="buddy-help">
                    <i class="fas fa-question-circle"></i> Help
                </button>
            </div>
            <div id="buddy-response" style="margin-top: 1rem; padding: 1rem; background: var(--bg-secondary); border-radius: 8px; display: none;">
                <!-- AI responses will appear here -->
            </div>
        </div>
    </div>

    <!-- Distraction Detection Modal -->
    <div class="distraction-modal" id="distraction-modal">
        <div class="distraction-content">
            <h3><i class="fas fa-exclamation-triangle"></i> Distraction Detected!</h3>
            <p>It looks like you might be getting distracted. Would you like to switch to a more engaging learning mode?</p>
            <div style="margin-top: 1.5rem; display: flex; gap: 1rem; justify-content: center;">
                <button class="btn btn-primary" id="switch-to-game">
                    <i class="fas fa-gamepad"></i> Switch to Game Mode
                </button>
                <button class="btn" id="continue-focus">
                    <i class="fas fa-eye"></i> Continue Focusing
                </button>
            </div>
        </div>
    </div>

    <!-- Celebration Modal -->
    <div class="celebration-modal" id="celebration-modal">
        <div class="celebration-content">
            <div class="celebration-emoji">üéâ</div>
            <h2>Well Done!</h2>
            <p>You've completed another lesson! Keep up the great work!</p>
            <div id="session-stats" style="margin: 1.5rem 0; padding: 1rem; background: var(--bg-secondary); border-radius: 8px;">
                <!-- Session statistics will be shown here -->
            </div>
            <button class="btn btn-success" id="continue-learning">
                <i class="fas fa-arrow-right"></i> Continue Learning
            </button>
        </div>
    </div>

    <!-- Audio elements for feedback -->
    <audio id="success-sound" preload="auto">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT" type="audio/wav">
    </audio>

    <audio id="notification-sound" preload="auto">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT" type="audio/wav">
    </audio>